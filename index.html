<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ë‚´ ë¯¸ë‹ˆê²Œì„ ì²œêµ­ PRO</title>
    <style>
        /* --- ê³µí†µ ìŠ¤íƒ€ì¼ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #202124; color: #fff; /* ë‹¤í¬ ëª¨ë“œ ê¸°ë°˜ */
            margin: 0; padding: 10px; text-align: center;
            user-select: none;
        }
        .container {
            background-color: #303134; padding: 20px; border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5); max-width: 600px; margin: 0 auto;
        }
        h2 { color: #8ab4f8; margin: 0 0 10px 0; }
        .desc { font-size: 13px; color: #9aa0a6; margin-bottom: 20px; }
        
        /* ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ */
        .input-group { margin-bottom: 15px; text-align: left; background: #3c4043; padding: 10px; border-radius: 8px;}
        .input-group label { display: block; font-size: 12px; color: #8ab4f8; margin-bottom: 5px; }
        input[type="text"] {
            width: 95%; padding: 10px; background: #202124; border: 1px solid #5f6368; 
            border-radius: 5px; color: #fff; font-size: 16px;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn {
            background-color: #8ab4f8; color: #202124; border: none; padding: 15px 0;
            font-size: 15px; border-radius: 8px; cursor: pointer; font-weight: bold;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }
        .btn:disabled { background-color: #5f6368; color: #aaa; cursor: not-allowed; }
        .btn-full { grid-column: span 2; background-color: #fbbc04; } /* ë…¸ë€ìƒ‰ */
        .btn-red { background-color: #f28b82; } /* ë¹¨ê°„ìƒ‰ */
        .btn-green { background-color: #81c995; } /* ì´ˆë¡ìƒ‰ */
        .btn-home { background-color: #5f6368; color: #fff; width: 100%; margin-top: 20px; padding: 10px; }

        /* í™”ë©´ ì „í™˜ */
        .scene { display: none; animation: fadeIn 0.3s; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* ê²°ê³¼ì°½ */
        .result-box { 
            margin-top: 20px; padding: 15px; background: #3c4043; 
            border-radius: 10px; text-align: left; border: 1px solid #5f6368;
        }
        .rank-item { padding: 8px; border-bottom: 1px solid #5f6368; font-size: 16px;}
        .rank-1 { color: #fbbc04; font-weight: bold; font-size: 20px; border-bottom: 2px solid #fbbc04; }

        /* --- ğŸƒ ê²Œì„ 1: ë‹¬ë¦¬ê¸° --- */
        #track { width: 100%; border: 2px solid #5f6368; background: #202124; position: relative; border-radius: 10px; overflow: hidden; margin-top:10px; padding-bottom: 10px;}
        .lane { height: 45px; border-bottom: 1px dashed #3c4043; position: relative; margin-top: 5px;}
        .animal { position: absolute; left: 0; font-size: 28px; line-height: 45px; transition: left 0.2s linear; }
        .finish-line { position: absolute; right: 15px; top: 0; bottom: 0; width: 2px; background: #f28b82; z-index: 0;}
        .stumble { transform: rotate(-90deg); transition: transform 0.2s; } /* ë„˜ì–´ì§ íš¨ê³¼ */

        /* --- ğŸ² ê²Œì„ 2: ì œë¹„ë½‘ê¸° --- */
        .card-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: 20px; }
        .card {
            width: 70px; height: 90px; background: #8ab4f8; color: #202124;
            border-radius: 5px; display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 20px; cursor: pointer;
        }
        .card.flipped { background: #fff; transform: rotateY(180deg); transition: 0.5s; }
        
        /* --- ğŸŒ³ ê²Œì„ 3: ë²„í‹°ëŠ” ì—´ë§¤ --- */
        #tree-area { height: 300px; position: relative; background: #e8f5e9; border-radius: 15px; overflow: hidden; margin-top: 10px; }
        #tree-leaves {
            width: 260px; height: 180px; background: #388e3c; border-radius: 50% 50% 40% 40%;
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1; transform-origin: top center;
        }
        #tree-trunk { width: 30px; height: 120px; background: #5d4037; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); }
        .shaking { animation: heavyShake 0.2s infinite; }
        @keyframes heavyShake {
            0% { transform: translateX(-50%) rotate(2deg); }
            50% { transform: translateX(-50%) rotate(-2deg); }
            100% { transform: translateX(-50%) rotate(2deg); }
        }
        .fruit {
            position: absolute; width: 40px; height: 40px; background: #ff7043; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; font-size: 11px; color: white; font-weight: bold;
            z-index: 2; transition: top 0.3s ease-in; box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }
        .dangling { animation: dangle 1s infinite; transform-origin: top center; }
        @keyframes dangle { 0%{transform: rotate(5deg);} 50%{transform: rotate(-5deg);} 100%{transform: rotate(5deg);} }

        /* --- ğŸ’£ ê²Œì„ 4: í­íƒ„ í•´ì²´ --- */
        #bomb-area { text-align: center; margin-top: 20px; }
        #bomb-display { font-size: 60px; margin: 20px 0; }
        .wire-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .wire-btn { 
            padding: 10px 15px; border-radius: 5px; border: none; font-weight: bold; cursor: pointer; 
            background: #5f6368; color: white; flex: 1 0 40%; 
        }
        .wire-safe { background: #81c995 !important; opacity: 0.5; }
        .wire-boom { background: #f28b82 !important; animation: shake 0.5s; }

        /* --- ğŸŒ‰ ê²Œì„ 5: ìœ ë¦¬ë‹¤ë¦¬ --- */
        #bridge-area { 
            display: flex; flex-direction: column-reverse; align-items: center; 
            background: #000; padding: 20px; border-radius: 10px; height: 400px; overflow-y: auto;
            perspective: 600px;
        }
        .bridge-step { 
            display: flex; justify-content: space-between; width: 200px; margin-bottom: 15px; 
            transform: rotateX(20deg);
        }
        .glass { 
            width: 90px; height: 60px; background: rgba(138, 180, 248, 0.3); 
            border: 2px solid #8ab4f8; display: flex; align-items: center; justify-content: center;
            cursor: pointer; color: #fff; font-size: 12px; transition: 0.3s;
        }
        .glass-break { background: none; border: none; font-size: 0; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10"><path d="M0 0 L10 10 M10 0 L0 10" stroke="white"/></svg>'); }
        .player-token { font-size: 24px; position: absolute; transition: all 0.5s; z-index: 10; text-shadow: 0 0 5px #000;}

    </style>
</head>
<body>

    <div class="container">
        <div id="scene-menu" class="scene active">
            <h2>ğŸ® ì‚¬ë‚´ ë¯¸ë‹ˆê²Œì„ ì²œêµ­ PRO</h2>
            <p class="desc">ë” ê¸¸ê³ , ë” ì«„ê¹ƒí•˜ê²Œ!</p>
            
            <div class="input-group">
                <label>ğŸ“Œ ë°© ì½”ë“œ (ë™ê¸°í™”ìš©)</label>
                <input type="text" id="room-code" placeholder="ì˜ˆ: ì ì‹¬ë‚´ê¸° (ë¹„ìš°ë©´ ëœë¤)">
            </div>
            <div class="input-group">
                <label>ğŸ‘¥ ì°¸ê°€ì (ì´ë¦„ì„ ì½¤ë§ˆë¡œ êµ¬ë¶„)</label>
                <input type="text" id="global-names" value="ê¹€ëŒ€ë¦¬,ì´ê³¼ì¥,ë°•ì‚¬ì›,ìµœíŒ€ì¥,ì •ì¸í„´">
            </div>

            <div class="btn-grid">
                <button class="btn" onclick="goToGame('race')">ğŸƒ ë‹¬ë¦¬ê¸° (30ì´ˆ)</button>
                <button class="btn btn-red" onclick="goToGame('bomb')">ğŸ’£ í­íƒ„ í•´ì²´</button>
                <button class="btn btn-green" onclick="goToGame('fruit')">ğŸŒ³ ë²„í‹°ëŠ” ì—´ë§¤</button>
                <button class="btn" onclick="goToGame('bridge')">ğŸŒ‰ ìœ ë¦¬ë‹¤ë¦¬</button>
                <button class="btn btn-full" onclick="goToGame('draw')">ğŸ² ë¹ ë¥¸ ì œë¹„ë½‘ê¸°</button>
            </div>
        </div>

        <div id="scene-race" class="scene">
            <h3>ğŸƒ ëŒ€ì—­ì „ ë ˆì´ìŠ¤</h3>
            <p class="desc">ë„˜ì–´ì§€ë©´ ëì¥ì…ë‹ˆë‹¤.</p>
            <div id="track"></div>
            <br>
            <button class="btn btn-full" id="btn-race-start" onclick="startRace()">ì¤€ë¹„... ë•…!</button>
            <div id="race-result" class="result-box" style="display:none;"></div>
            <button class="btn btn-home" onclick="goHome()">ë©”ì¸ìœ¼ë¡œ</button>
        </div>

        <div id="scene-bomb" class="scene">
            <h3>ğŸ’£ í­íƒ„ í•´ì²´ë°˜</h3>
            <p class="desc">ê°€ìœ„ë°”ìœ„ë³´ ìˆœì„œëŒ€ë¡œ ì„ ì„ ìë¥´ì„¸ìš”.</p>
            <div id="bomb-display">ğŸ’£</div>
            <div id="wire-box" class="wire-container"></div>
            <div id="bomb-status" style="margin:10px; height: 20px; color: #f28b82;"></div>
            <div id="bomb-result" class="result-box" style="display:none;"></div>
            <button class="btn btn-home" onclick="goHome()">ë©”ì¸ìœ¼ë¡œ</button>
        </div>

        <div id="scene-fruit" class="scene">
            <h3>ğŸŒ³ ëˆì§ˆê¸´ ë…€ì„ë“¤</h3>
            <p class="desc">ë§ˆì§€ë§‰ê¹Œì§€ ë§¤ë‹¬ë¦° ì‚¬ëŒì´ ìŠ¹ë¦¬!</p>
            <div id="tree-area">
                <div id="tree-leaves"></div>
                <div id="tree-trunk"></div>
            </div>
            <br>
            <button class="btn btn-green" id="btn-fruit-start" onclick="startFruit()">ë‚˜ë¬´ í”ë“¤ê¸°!</button>
            <div id="fruit-result" class="result-box" style="display:none;"></div>
            <button class="btn btn-home" onclick="goHome()">ë©”ì¸ìœ¼ë¡œ</button>
        </div>

        <div id="scene-bridge" class="scene">
            <h3>ğŸŒ‰ ìš´ëª…ì˜ ìœ ë¦¬ë‹¤ë¦¬</h3>
            <p class="desc">ëˆ„ê°€ ê°€ì¥ ë©€ë¦¬ ê°ˆê¹Œìš”?</p>
            <div id="bridge-area"></div>
            <br>
            <button class="btn" id="btn-bridge-start" onclick="startBridge()">ê²Œì„ ì‹œì‘</button>
            <div id="bridge-result" class="result-box" style="display:none;"></div>
            <button class="btn btn-home" onclick="goHome()">ë©”ì¸ìœ¼ë¡œ</button>
        </div>

        <div id="scene-draw" class="scene">
            <h3>ğŸ² ìŠ¤í”¼ë“œ ì œë¹„ë½‘ê¸°</h3>
            <div id="draw-area" class="card-grid"></div>
            <br>
            <button class="btn btn-full" id="btn-draw-start" onclick="startDraw()">ì˜¤í”ˆ!</button>
            <div id="draw-result" class="result-box" style="display:none;"></div>
            <button class="btn btn-home" onclick="goHome()">ë©”ì¸ìœ¼ë¡œ</button>
        </div>
    </div>

    <script>
        // --- ëœë¤ ì‹œë“œ ë¡œì§ (ë™ê¸°í™” í•µì‹¬) ---
        let seedValue = 0;
        function setSeed(str) {
            let h = 2166136261 >>> 0;
            for (let i = 0; i < str.length; i++) h = Math.imul(h ^ str.charCodeAt(i), 16777619);
            seedValue = h >>> 0;
        }
        function myRandom() {
            if (!document.getElementById('room-code').value.trim()) return Math.random();
            seedValue = (Math.imul(1664525, seedValue) + 1013904223) | 0;
            return ((seedValue >>> 0) / 4294967296);
        }
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(myRandom() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- ê³µí†µ ë³€ìˆ˜ ---
        let participants = [];
        const animals = ['ğŸ¶','ğŸ±','ğŸ¹','ğŸ¦Š','ğŸ»','ğŸ¼','ğŸ¸','ğŸ°','ğŸ¯','ğŸ¦'];
        
        function goHome() {
            document.querySelectorAll('.scene').forEach(el => el.classList.remove('active'));
            document.getElementById('scene-menu').classList.add('active');
        }

        function goToGame(gameType) {
            const inputName = document.getElementById('global-names').value;
            const inputCode = document.getElementById('room-code').value;
            
            participants = inputName.split(',').map(n => n.trim()).filter(n => n);
            if (participants.length < 2) { alert("ìµœì†Œ 2ëª… ì´ìƒ!"); return; }

            if(inputCode.trim()) setSeed(inputCode + gameType);

            document.querySelectorAll('.scene').forEach(el => el.classList.remove('active'));
            document.getElementById(`scene-${gameType}`).classList.add('active');

            if(gameType === 'race') initRace();
            if(gameType === 'bomb') initBomb();
            if(gameType === 'fruit') initFruit();
            if(gameType === 'bridge') initBridge();
            if(gameType === 'draw') initDraw();
        }

        function showResult(elId, list, title="ğŸ† ìˆœìœ„ ë°œí‘œ") {
            const box = document.getElementById(elId);
            box.style.display = 'block';
            let html = `<h4>${title}</h4>`;
            list.forEach((name, i) => {
                html += `<div class="rank-item ${i===0?'rank-1':''}">${i+1}ìœ„ : ${name}</div>`;
            });
            box.innerHTML = html;
        }

        // -------------------------
        // 1. ë‹¬ë¦¬ê¸° (ì—…ê·¸ë ˆì´ë“œ: ìŠ¤í„´ ì¶”ê°€, ì†ë„ ì €í•˜)
        // -------------------------
        function initRace() {
            const track = document.getElementById('track');
            track.innerHTML = '<div class="finish-line"></div>';
            document.getElementById('race-result').style.display = 'none';
            document.getElementById('btn-race-start').disabled = false;
            
            participants.forEach((name, i) => {
                const lane = document.createElement('div');
                lane.className = 'lane';
                lane.innerHTML = `<span id="racer-${i}" class="animal" style="left:0%">${animals[i%animals.length]}</span> <small style="margin-left:5px; position: absolute; left: 0; bottom: 0; font-size:10px; color:#aaa;">${name}</small>`;
                track.appendChild(lane);
            });
        }
        function startRace() {
            document.getElementById('btn-race-start').disabled = true;
            let racers = participants.map((name, i) => ({ id: i, name: name, pos: 0, finished: false, stun: 0 }));
            let rank = [];
            
            const raceInterval = setInterval(() => {
                let allFinished = true;
                racers.forEach(r => {
                    if (!r.finished) {
                        allFinished = false;
                        const el = document.getElementById(`racer-${r.id}`);
                        
                        // ìŠ¤í„´ ìƒíƒœë©´ ëª» ì›€ì§ì„
                        if (r.stun > 0) {
                            r.stun--;
                            el.style.transform = 'rotate(-90deg)'; // ëˆ„ìš´ ëª¨ìŠµ
                            return; 
                        } else {
                            el.style.transform = 'rotate(0deg)';
                        }

                        // ì´ë™ ë¡œì§ (ì¡°ê¸ˆ ëŠë¦¬ê²Œ, í¸ì°¨ í¬ê²Œ)
                        let move = myRandom() * 1.5; 
                        if(myRandom() > 0.98) { move += 5; } // ë¶€ìŠ¤í„°
                        if(myRandom() > 0.98) { r.stun = 15; } // 1.5ì´ˆ ë„˜ì–´ì§ (ìŠ¤ë¦´ ìš”ì†Œ)

                        r.pos += move;
                        if (r.pos >= 88) {
                            r.pos = 88;
                            r.finished = true;
                            rank.push(r.name);
                        }
                        el.style.left = r.pos + '%';
                    }
                });
                if (allFinished) { clearInterval(raceInterval); showResult('race-result', rank); }
            }, 100); // 0.1ì´ˆë§ˆë‹¤ ê°±ì‹  (ì¢€ ë” ë¶€ë“œëŸ½ê²Œ)
        }

        // -------------------------
        // 2. í­íƒ„ í•´ì²´ (ì‹ ê·œ: ëŸ¬ì‹œì•ˆ ë£°ë ›)
        // -------------------------
        let bombPlayers = [];
        let bombIndex = 0;
        function initBomb() {
            document.getElementById('wire-box').innerHTML = '';
            document.getElementById('bomb-status').innerText = '';
            document.getElementById('bomb-result').style.display = 'none';
            document.getElementById('bomb-display').innerText = 'ğŸ’£';
            
            // í”Œë ˆì´ì–´ ìˆœì„œ ì„ê¸°
            bombPlayers = shuffle([...participants]);
            const box = document.getElementById('wire-box');
            
            bombPlayers.forEach((p, i) => {
                const btn = document.createElement('button');
                btn.className = 'wire-btn';
                btn.innerText = `âœ‚ï¸ ${p}`;
                btn.id = `wire-${i}`;
                btn.onclick = () => cutWire(i, p);
                box.appendChild(btn);
            });
            
            // í­íƒ„ í„°ì§ˆ ìˆœì„œ ë¯¸ë¦¬ ì •í•´ë†“ê¸° (ì‹œë“œ ê¸°ë°˜)
            bombIndex = Math.floor(myRandom() * bombPlayers.length); 
            // íŒíŠ¸: bombIndex ë²ˆì§¸ ì‚¬ëŒì´ ìë¥´ë©´ í„°ì§
        }
        
        function cutWire(idx, name) {
            const status = document.getElementById('bomb-status');
            const btn = document.getElementById(`wire-${idx}`);
            btn.disabled = true;
            
            status.innerText = `${name}ë‹˜ì´ ì„ ì„ ìë¥´ëŠ” ì¤‘...`;
            
            setTimeout(() => {
                if (idx === bombIndex) {
                    // ê½!
                    document.getElementById('bomb-display').innerText = 'ğŸ’¥';
                    btn.classList.add('wire-boom');
                    status.innerText = "í‘!!!!";
                    // í„°ì§„ ì‚¬ëŒì´ ê¼´ì°Œ, ë‚˜ë¨¸ì§€ëŠ” ìƒì¡´
                    let rank = bombPlayers.filter((_, i) => i !== idx); // ìƒì¡´ì
                    rank.push(name); // ê¼´ì°Œ ì¶”ê°€
                    showResult('bomb-result', rank.reverse(), "ğŸ’€ ìƒì¡´ì ëª…ë‹¨ (ë§ˆì§€ë§‰ì´ ê½)");
                    
                    // ë‚˜ë¨¸ì§€ ë²„íŠ¼ ë¹„í™œì„±
                    document.querySelectorAll('.wire-btn').forEach(b => b.disabled = true);
                } else {
                    // í†µê³¼
                    btn.classList.add('wire-safe');
                    status.innerText = "íœ´... ì•ˆì „í•©ë‹ˆë‹¤.";
                }
            }, 1000); // 1ì´ˆ ì«„ê¹ƒí•¨
        }

        // -------------------------
        // 3. ì—´ë§¤ (ì—…ê·¸ë ˆì´ë“œ: í”ë“¤ê¸° ì‹œê°„ ì¦ê°€)
        // -------------------------
        function initFruit() {
            const tree = document.getElementById('tree-leaves');
            tree.innerHTML = ''; tree.classList.remove('shaking');
            document.getElementById('fruit-result').style.display = 'none';
            document.getElementById('btn-fruit-start').disabled = false;
            
            participants.forEach((name, i) => {
                const fruit = document.createElement('div');
                fruit.className = 'fruit dangling'; // í”ë“¤ê±°ë¦¼ ì¶”ê°€
                fruit.id = `fruit-${i}`;
                fruit.innerText = name;
                fruit.style.left = (Math.random() * 200 + 10) + 'px'; 
                fruit.style.top = (Math.random() * 100 + 20) + 'px';
                tree.appendChild(fruit);
            });
        }
        function startFruit() {
            document.getElementById('btn-fruit-start').disabled = true;
            const tree = document.getElementById('tree-leaves');
            tree.classList.add('shaking');
            
            let fallenCount = 0;
            let fallOrder = [];
            // ë–¨ì–´ì§€ëŠ” ì‹œê°„ ë²”ìœ„ ëŒ€í­ ì¦ê°€ (ìµœëŒ€ 8ì´ˆ)
            let times = participants.map(name => ({ name: name, time: myRandom() * 6000 + 2000 }));
            times.sort((a, b) => a.time - b.time);

            times.forEach((item) => {
                setTimeout(() => {
                    const elements = Array.from(document.querySelectorAll('.fruit:not(.fallen)'));
                    const target = elements.find(el => el.innerText === item.name);
                    if(target) {
                        target.style.top = '300px'; 
                        target.classList.add('fallen');
                        target.classList.remove('dangling');
                    }
                    fallenCount++;
                    fallOrder.push(item.name);
                    if (fallenCount === participants.length) {
                        tree.classList.remove('shaking');
                        showResult('fruit-result', fallOrder.reverse());
                    }
                }, item.time);
            });
        }

        // -------------------------
        // 4. ìœ ë¦¬ë‹¤ë¦¬ (ì‹ ê·œ: ì˜¤ì§•ì–´ ê²Œì„)
        // -------------------------
        let bridgeStep = 0;
        let bridgePlayers = [];
        let bridgeMap = []; // 0: left safe, 1: right safe
        
        function initBridge() {
            const area = document.getElementById('bridge-area');
            area.innerHTML = '';
            document.getElementById('bridge-result').style.display = 'none';
            document.getElementById('btn-bridge-start').disabled = false;
            bridgePlayers = shuffle([...participants]);
            bridgeMap = [];
            
            // ë‹¤ë¦¬ ìƒì„± (ì°¸ê°€ì ìˆ˜ * 1.5ë°° ê¸¸ì´)
            const len = Math.max(5, participants.length + 3);
            for(let i=0; i<len; i++) {
                bridgeMap.push(myRandom() > 0.5 ? 0 : 1); // ì •ë‹µ ìƒì„±
                const step = document.createElement('div');
                step.className = 'bridge-step';
                step.innerHTML = `
                    <div class="glass" id="g-${i}-0" onclick="stepBridge(${i}, 0)">L</div>
                    <div class="glass" id="g-${i}-1" onclick="stepBridge(${i}, 1)">R</div>
                `;
                area.prepend(step); // ì•„ë˜ì„œë¶€í„° ìŒ“ê¸°
            }
            bridgeStep = 0;
        }

        function startBridge() {
            document.getElementById('btn-bridge-start').disabled = true;
            alert(`ì²« ë²ˆì§¸ ì£¼ì: ${bridgePlayers[0]}ë‹˜ ì¶œë°œí•˜ì„¸ìš”!`);
            highlightStep(0);
        }

        function highlightStep(idx) {
            // í˜„ì¬ ë°Ÿì•„ì•¼ í•  ë‹¨ê³„ í‘œì‹œ (ê°„ë‹¨íˆ ìƒ‰ìƒ ë³€ê²½ ë“± ê°€ëŠ¥í•˜ë‚˜ ì—¬ê¸°ì„  ìƒëµ)
        }

        function stepBridge(row, choice) {
            if (row !== bridgeStep) return; // ì°¨ë¡€ê°€ ì•„ë‹Œ ì¹¸ í´ë¦­ ë°©ì§€
            
            const currentPlayer = bridgePlayers[0];
            const correct = bridgeMap[row];
            const glass = document.getElementById(`g-${row}-${choice}`);
            
            if (choice === correct) {
                // ì„±ê³µ
                glass.style.background = "#81c995"; // ì´ˆë¡
                glass.innerText = currentPlayer;
                bridgeStep++;
                if (bridgeStep === bridgeMap.length) {
                    alert(`${currentPlayer}ë‹˜ í†µê³¼! ìš°ìŠ¹!`);
                    showResult('bridge-result', [currentPlayer, ...bridgePlayers.slice(1)], "ğŸ† ìµœì¢… ìƒì¡´ì");
                }
            } else {
                // ì‹¤íŒ¨ (ì™€ì¥ì°½)
                glass.classList.add('glass-break');
                alert(`ìœ¼ì•…! ${currentPlayer} íƒˆë½!`);
                // íƒˆë½ì ëª…ë‹¨ ë§¨ ë’¤ë¡œ ê¸°ë¡í•˜ê±°ë‚˜ ë³„ë„ ì²˜ë¦¬
                // ì—¬ê¸°ì„  ê°„ë‹¨íˆ ë‹¤ìŒ ì‚¬ëŒì—ê²Œ í„´ ë„˜ê¹€
                bridgePlayers.shift(); // í˜„ì¬ ì£¼ì ì œê±°
                if (bridgePlayers.length === 0) {
                    alert("ì „ì› íƒˆë½... ê²Œì„ ì˜¤ë²„");
                    showResult('bridge-result', participants, "ğŸ’€ ì „ì› ì‚¬ë§ (ê¸°ë¡ ì—†ìŒ)");
                } else {
                    alert(`ë‹¤ìŒ ì£¼ì: ${bridgePlayers[0]}ë‹˜!`);
                }
            }
        }

        // -------------------------
        // 5. ì œë¹„ë½‘ê¸° (ê¸°ì¡´ ìœ ì§€)
        // -------------------------
        function initDraw() {
            const area = document.getElementById('draw-area');
            area.innerHTML = '';
            document.getElementById('draw-result').style.display = 'none';
            document.getElementById('btn-draw-start').disabled = false;
            participants.forEach(() => area.innerHTML += '<div class="card">?</div>');
        }
        function startDraw() {
            document.getElementById('btn-draw-start').disabled = true;
            const area = document.getElementById('draw-area');
            area.innerHTML = '';
            let shuffled = shuffle([...participants]);
            shuffled.forEach((name, i) => {
                const card = document.createElement('div');
                card.className = 'card'; card.innerText = '?';
                area.appendChild(card);
                setTimeout(() => {
                    card.classList.add('flipped');
                    card.innerText = `${i+1}ë“±\n${name}`;
                    card.style.fontSize = "14px";
                }, i * 300 + 200);
            });
            setTimeout(() => showResult('draw-result', shuffled), participants.length * 300 + 500);
        }
    </script>
</body>
</html>
